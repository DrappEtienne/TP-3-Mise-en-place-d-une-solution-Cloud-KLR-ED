{
  "version": 4,
  "terraform_version": "1.1.4",
  "serial": 33,
  "lineage": "c3e428be-3382-a7bf-36a6-851c5e2dd3f2",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "scaleway_instance_ip",
      "name": "public_ip",
      "provider": "provider[\"registry.terraform.io/scaleway/scaleway\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address": "51.15.209.133",
            "id": "fr-par-1/d02bd607-0626-4e06-be97-313e12fe420b",
            "organization_id": "72e8d1b0-d312-4b4f-b0b3-982435805410",
            "project_id": "72e8d1b0-d312-4b4f-b0b3-982435805410",
            "reverse": "",
            "server_id": "",
            "timeouts": null,
            "zone": "fr-par-1"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMCwiZGVmYXVsdCI6NjAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "scaleway_instance_server",
      "name": "web",
      "provider": "provider[\"registry.terraform.io/scaleway/scaleway\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "additional_volume_ids": null,
            "boot_type": "local",
            "bootscript_id": "fdfe150f-a870-4ce4-b432-9f56b5b995c1",
            "cloud_init": null,
            "enable_dynamic_ip": false,
            "enable_ipv6": false,
            "id": "fr-par-1/291ced53-f6d5-4986-86eb-51d7eec626fe",
            "image": "debian_bullseye",
            "ip_id": "fr-par-1/d02bd607-0626-4e06-be97-313e12fe420b",
            "ipv6_address": "",
            "ipv6_gateway": "",
            "ipv6_prefix_length": 0,
            "name": "tf-srv-kind-keller",
            "organization_id": "72e8d1b0-d312-4b4f-b0b3-982435805410",
            "placement_group_id": null,
            "placement_group_policy_respected": null,
            "private_ip": "10.64.252.109",
            "private_network": [],
            "project_id": "72e8d1b0-d312-4b4f-b0b3-982435805410",
            "public_ip": "51.15.209.133",
            "root_volume": [
              {
                "boot": false,
                "delete_on_termination": true,
                "size_in_gb": 20,
                "volume_id": "fr-par-1/737ebd62-8b06-44e9-a480-3e048ec02b4f"
              }
            ],
            "security_group_id": "fr-par-1/02d00028-dd0c-4acc-99c0-afdea14c575b",
            "state": "started",
            "tags": null,
            "timeouts": null,
            "type": "DEV1-S",
            "user_data": {
              "cloud-init": "#!/bin/sh\necho \"Updating ...\"\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\necho \"Installing APACHE2 ...\"\nsudo apt install apache2 php php-mysql php-mysqlnd php-ldap php-bcmath php-mbstring php-gd php-pdo php-xml libapache2-mod-php\n\necho \"Enabling APACHE2\"\nsudo systemctl enable apache2\n\necho \"Restaring APACHE2\"\nsudo systemctl restart apache2\n\necho \"Installing MARIADB ...\"\nsudo apt install mariadb-server mariadb-client\n\necho \"Configuration of database mysql ...\"\nsudo mysql -e \"drop database if exists zabbix;\"\nsudo mysql -e \"create database if not exists zabbix character set utf8 collate utf8_bin;\"\nsudo mysql -e \"create user if not exists 'zabbix'@'localhost' identified by 'Epsi'\"\nsudo mysql -e \"grant all privileges on zabbix.* to 'zabbix'@'localhost' identified by 'Epsi'\"\n\nsudo touch ~/.my.cnf\n\nsudo sed -i '1i[mysql]' ~/.my.cnf\nsudo sed -i '2iuser = zabbix' ~/.my.cnf\nsudo sed -i '3ipassword = Epsi' ~/.my.cnf\n\nsudo chmod 760 ~/.my.cnf\n\necho \"Get Zabbix Repo 5.4-1 debian11\"\nsudo wget --no-check-certificate https://repo.zabbix.com/zabbix/5.4/debian/pool/main/z/zabbix-release/zabbix-release_5.4-1+debian11_all.deb\n\necho \"DPKG Zabbix repo\"\nsudo dpkg -i zabbix-release_5.4-1+debian11_all.deb\n\necho \"Updating...\"\nsudo apt update -y\n\necho \"Installing Zabbix ...\"\nsudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent -y\n\necho \"Installing Zabbix Database ...\"\nsudo zcat /usr/share/doc/zabbix-sql-scripts/mysql/create.sql.gz | sudo mysql -uzabbix -p zabbix --password=Epsi\n\necho \"Configuration of zabbix server files ...\"\nsudo sed -i '/# DB=Host/c\\DBHOST=localhost' /etc/zabbix/zabbix_server.conf\nsudo sed -i '/DBName=/c\\DBName=zabbix' /etc/zabbix/zabbix_server.conf\nsudo sed -i '/DBUser=/c\\DBUser=zabbix' /etc/zabbix/zabbix_server.conf\nsudo sed -i '/DBPassword=/c\\DBPassword=Epsi' /etc/zabbix/zabbix_server.conf\n\n# php_value date.timezone Europe/Riga\necho \"Editing Timezone for Europe/Riga ...\"\nsudo sed -i 's/# php_value date.timezone Europe/Riga/php_value date.timezone Europe/Riga/' /etc/zabbix/apache.conf\n\necho \"Restarting and Enabling Services ...\"\nsudo systemctl restart apache2\n\nsudo systemctl start zabbix-server zabbix-agent\n\nsudo systemctl enable zabbix-server zabbix-agent\n\nsudo systemctl status zabbix-server\n\nsudo systemctl status zabbix-agent\n\nsudo ufw allow 80/tcp\n\nsudo ufw allow 443/tcp\n\nsudo ufw reload\n"
            },
            "zone": "fr-par-1"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlZmF1bHQiOjYwMDAwMDAwMDAwMCwiZGVsZXRlIjo2MDAwMDAwMDAwMDAsInJlYWQiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "scaleway_instance_ip.public_ip"
          ]
        }
      ]
    }
  ]
}
